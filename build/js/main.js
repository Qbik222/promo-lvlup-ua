"use strict";

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }
function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }
function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }
function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }
function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }
document.addEventListener("DOMContentLoaded", function () {
  var slides = document.querySelectorAll(".slide");
  var leftBtn = document.querySelector(".slide__move-left");
  var rightBtn = document.querySelector(".slide__move-right");
  var slidesIcons = document.querySelectorAll(".quests__icons-item");
  var glitchLayers = [];
  var current = 1;
  // let week = 2;
  var week = localStorage.getItem("week") ? parseInt(localStorage.getItem("week")) : 1;
  if (week === 1) {
    slides.forEach(function (slide, i) {
      if (i >= 6 || slide.classList.contains("quest".concat(i))) {
        slide.remove();
      }
    });
    slidesIcons.forEach(function (icon, i) {
      if (i >= 6 || icon.classList.contains("quest".concat(i))) {
        icon.remove();
      }
    });
  }
  if (week === 2) {
    for (var i = 1; i <= 6; i++) {
      var _week = document.querySelectorAll(".quest".concat(i));
      _week.forEach(function (item) {
        item.remove();
      });
    }
  }
  slides.forEach(function (slide) {
    glitchLayers = [].concat(_toConsumableArray(glitchLayers), _toConsumableArray(slide.querySelectorAll(".glitch__layer")));
  });
  slides[current].classList.add("_active");
  function updateGlitchLayers(index) {
    if (week === 2) {
      index += 6;
    }
    glitchLayers.forEach(function (layer) {
      layer.classList.forEach(function (className) {
        if (className.startsWith("slide-info-glitch")) {
          layer.classList.remove("slide-info-glitch");
        }
        if (className.startsWith("quest")) {
          layer.classList.remove(className);
        }
      });
      if (layer.parentElement.parentElement.classList[0] !== "slide__info") {
        layer.classList.add("quest".concat(index));
        layer.style.background = "url(\"./img/quests/slide".concat(index, "/pers.png\") no-repeat 0 0/contain");
      } else {
        layer.classList.add("slide-info-glitch");
      }
    });
  }
  function moveSlider(slides, direction) {
    if (direction === "left") {
      --current;
      if (current < 0) current = slides.length - 1;
    } else if (direction === "right") {
      ++current;
      if (current > slides.length - 1) current = 0;
    }
    slides.forEach(function (slide, i) {
      slide.classList.toggle("_active", i === current);
      slide.classList.remove("glitch");
    });
    SlideIconsInit(slidesIcons, current);
  }
  function SlideIconsInit(icons, current) {
    icons.forEach(function (icon, iconIndex) {
      icon.classList.toggle("_current", current === iconIndex);
    });
  }
  function handleClick(direction) {
    slides[current].classList.add("glitch");
    rightBtn.style.pointerEvents = "none";
    leftBtn.style.pointerEvents = "none";
    var nextSlideIndex = direction === "left" ? current === 0 ? slides.length : current : current === slides.length - 1 ? 1 : current + 2;
    updateGlitchLayers(nextSlideIndex);
    setTimeout(function () {
      glitchLayers.forEach(function (layer) {
        layer.classList.forEach(function (className) {
          if (className.startsWith("slide-info-glitch") || className.startsWith("quest")) {
            layer.classList.remove(className);
          }
        });
      });
      moveSlider(slides, direction);
      rightBtn.style.pointerEvents = "initial";
      leftBtn.style.pointerEvents = "initial";
    }, 1000);
  }
  leftBtn.addEventListener("click", function () {
    return handleClick("left");
  });
  rightBtn.addEventListener("click", function () {
    return handleClick("right");
  });
  slidesIcons.forEach(function (icon, i) {
    icon.addEventListener("click", function () {
      setTimeout(function () {
        slidesIcons.forEach(function (item) {
          return item.classList.remove("_current");
        });
      }, 1000);
      slides[current].classList.add("glitch");
      current = i;
      updateGlitchLayers(current + 1);
      setTimeout(function () {
        SlideIconsInit(slidesIcons, current);
        slides.forEach(function (slide, index) {
          slide.classList.toggle("_active", index === current);
          slide.classList.remove("glitch");
        });
        rightBtn.style.pointerEvents = "initial";
        leftBtn.style.pointerEvents = "initial";
      }, 1000);
    });
  });
  SlideIconsInit(slidesIcons, current);
  document.addEventListener("DOMContentLoaded", function () {
    var slides = document.querySelectorAll(".slide");
    var leftBtn = document.querySelector(".slide__move-left");
    var rightBtn = document.querySelector(".slide__move-right");
    var slidesIcons = document.querySelectorAll(".quests__icons-item");
    var glitchLayers = [];
    var current = 1;
    // let week = 2;
    var week = localStorage.getItem("week") ? parseInt(localStorage.getItem("week")) : 1;
    if (week === 1) {
      slides.forEach(function (slide, i) {
        if (i >= 6 || slide.classList.contains("quest".concat(i))) {
          slide.remove();
        }
      });
      slidesIcons.forEach(function (icon, i) {
        if (i >= 6 || icon.classList.contains("quest".concat(i))) {
          icon.remove();
        }
      });
    }
    if (week === 2) {
      for (var _i = 1; _i <= 6; _i++) {
        var _week2 = document.querySelectorAll(".quest".concat(_i));
        _week2.forEach(function (item) {
          item.remove();
        });
      }
    }
    slides.forEach(function (slide) {
      glitchLayers = [].concat(_toConsumableArray(glitchLayers), _toConsumableArray(slide.querySelectorAll(".glitch__layer")));
    });
    slides[current].classList.add("_active");
    function updateGlitchLayers(index) {
      if (week === 2) {
        index += 6;
      }
      glitchLayers.forEach(function (layer) {
        layer.classList.forEach(function (className) {
          if (className.startsWith("slide-info-glitch")) {
            layer.classList.remove("slide-info-glitch");
          }
          if (className.startsWith("quest")) {
            layer.classList.remove(className);
          }
        });
        if (layer.parentElement.parentElement.classList[0] !== "slide__info") {
          layer.classList.add("quest".concat(index));
          layer.style.background = "url(\"./img/quests/slide".concat(index, "/pers.png\") no-repeat 0 0/contain");
        } else {
          layer.classList.add("slide-info-glitch");
        }
      });
    }
    function moveSlider(slides, direction) {
      if (direction === "left") {
        --current;
        if (current < 0) current = slides.length - 1;
      } else if (direction === "right") {
        ++current;
        if (current > slides.length - 1) current = 0;
      }
      slides.forEach(function (slide, i) {
        slide.classList.toggle("_active", i === current);
        slide.classList.remove("glitch");
      });
      SlideIconsInit(slidesIcons, current);
    }
    function SlideIconsInit(icons, current) {
      icons.forEach(function (icon, iconIndex) {
        icon.classList.toggle("_current", current === iconIndex);
      });
    }
    function handleClick(direction) {
      slides[current].classList.add("glitch");
      rightBtn.style.pointerEvents = "none";
      leftBtn.style.pointerEvents = "none";
      var nextSlideIndex = direction === "left" ? current === 0 ? slides.length : current : current === slides.length - 1 ? 1 : current + 2;
      updateGlitchLayers(nextSlideIndex);
      setTimeout(function () {
        glitchLayers.forEach(function (layer) {
          layer.classList.forEach(function (className) {
            if (className.startsWith("slide-info-glitch") || className.startsWith("quest")) {
              layer.classList.remove(className);
            }
          });
        });
        moveSlider(slides, direction);
        rightBtn.style.pointerEvents = "initial";
        leftBtn.style.pointerEvents = "initial";
      }, 1000);
    }
    leftBtn.addEventListener("click", function () {
      return handleClick("left");
    });
    rightBtn.addEventListener("click", function () {
      return handleClick("right");
    });
    slidesIcons.forEach(function (icon, i) {
      icon.addEventListener("click", function () {
        setTimeout(function () {
          slidesIcons.forEach(function (item) {
            return item.classList.remove("_current");
          });
        }, 1000);
        slides[current].classList.add("glitch");
        current = i;
        updateGlitchLayers(current + 1);
        setTimeout(function () {
          SlideIconsInit(slidesIcons, current);
          slides.forEach(function (slide, index) {
            slide.classList.toggle("_active", index === current);
            slide.classList.remove("glitch");
          });
          rightBtn.style.pointerEvents = "initial";
          leftBtn.style.pointerEvents = "initial";
        }, 1000);
      });
    });
    SlideIconsInit(slidesIcons, current);

    // for test

    var week1 = document.querySelector(".week1");
    var week2 = document.querySelector(".week2");
    week1.addEventListener("click", function () {
      localStorage.setItem("week", 1);
      location.reload();
    });
    week2.addEventListener("click", function () {
      localStorage.setItem("week", 2);
      location.reload();
    });
  });
  function preloadImages() {
    for (var _i2 = 1; _i2 <= 12; _i2++) {
      var pers = new Image();
      var persMob = new Image();
      var slideBg = new Image();
      var slideBgMob = new Image();
      var mainBtn = new Image();
      pers.src = "./img/quests/slide".concat(_i2, "/pers.png");
      persMob.src = "./img/quests/slide".concat(_i2, "/pers-mob.png");
      slideBg.src = "./img/quests/slide".concat(_i2, "/slide-bg.png");
      slideBgMob.src = "./img/quests/slide".concat(_i2, "/slide-bg-mob.png");
      mainBtn.src = "./img/buttons/btn-hover-bg.png";
    }
  }
  preloadImages();

  // for test

  var week1 = document.querySelector(".week1");
  var week2 = document.querySelector(".week2");
  week1.addEventListener("click", function () {
    localStorage.setItem("week", 1);
    location.reload();
  });
  week2.addEventListener("click", function () {
    localStorage.setItem("week", 2);
    location.reload();
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwic2xpZGVzIiwicXVlcnlTZWxlY3RvckFsbCIsImxlZnRCdG4iLCJxdWVyeVNlbGVjdG9yIiwicmlnaHRCdG4iLCJzbGlkZXNJY29ucyIsImdsaXRjaExheWVycyIsImN1cnJlbnQiLCJ3ZWVrIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInBhcnNlSW50IiwiZm9yRWFjaCIsInNsaWRlIiwiaSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwiaWNvbiIsIndlZWsxIiwiaXRlbSIsImFkZCIsInVwZGF0ZUdsaXRjaExheWVycyIsImluZGV4IiwibGF5ZXIiLCJjbGFzc05hbWUiLCJzdGFydHNXaXRoIiwicGFyZW50RWxlbWVudCIsInN0eWxlIiwiYmFja2dyb3VuZCIsIm1vdmVTbGlkZXIiLCJkaXJlY3Rpb24iLCJsZW5ndGgiLCJ0b2dnbGUiLCJTbGlkZUljb25zSW5pdCIsImljb25zIiwiaWNvbkluZGV4IiwiaGFuZGxlQ2xpY2siLCJwb2ludGVyRXZlbnRzIiwibmV4dFNsaWRlSW5kZXgiLCJzZXRUaW1lb3V0Iiwid2VlazIiLCJzZXRJdGVtIiwibG9jYXRpb24iLCJyZWxvYWQiLCJwcmVsb2FkSW1hZ2VzIiwicGVycyIsIkltYWdlIiwicGVyc01vYiIsInNsaWRlQmciLCJzbGlkZUJnTW9iIiwibWFpbkJ0biIsInNyYyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQUEsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxZQUFLO0VBSS9DLElBQU1DLE1BQU0sR0FBR0YsUUFBUSxDQUFDRyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUM7RUFDbEQsSUFBTUMsT0FBTyxHQUFHSixRQUFRLENBQUNLLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQztFQUMzRCxJQUFNQyxRQUFRLEdBQUdOLFFBQVEsQ0FBQ0ssYUFBYSxDQUFDLG9CQUFvQixDQUFDO0VBQzdE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USxDQUFDSyxhQUFhLENBQUMsUUFBUSxDQUFDO0VBQzlDLElBQU1zQyxLQUFLLEdBQUczQyxRQUFRLENBQUNLLGFBQWEsQ0FBQyxRQUFRLENBQUM7RUFFOUNnQixLQUFLLENBQUNwQixnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBTTtJQUNsQ1UsWUFBWSxDQUFDaUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7SUFDL0JDLFFBQVEsQ0FBQ0MsTUFBTSxFQUFFO0VBQ3JCLENBQUMsQ0FBQztFQUVGSCxLQUFLLENBQUMxQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBTTtJQUNsQ1UsWUFBWSxDQUFDaUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7SUFDL0JDLFFBQVEsQ0FBQ0MsTUFBTSxFQUFFO0VBQ3JCLENBQUMsQ0FBQztBQUdOLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT57XG5cblxuXG4gICAgY29uc3Qgc2xpZGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZVwiKTtcbiAgICBjb25zdCBsZWZ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZV9fbW92ZS1sZWZ0XCIpO1xuICAgIGNvbnN0IHJpZ2h0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZV9fbW92ZS1yaWdodFwiKTtcbiAgICBjb25zdCBzbGlkZXNJY29ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucXVlc3RzX19pY29ucy1pdGVtXCIpO1xuXG4gICAgbGV0IGdsaXRjaExheWVycyA9IFtdO1xuICAgIGxldCBjdXJyZW50ID0gMTtcbiAgICAvLyBsZXQgd2VlayA9IDI7XG4gICAgbGV0IHdlZWsgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIndlZWtcIikgPyBwYXJzZUludChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIndlZWtcIikpIDogMTtcblxuICAgIGlmKHdlZWsgPT09IDEpe1xuICAgICAgICBzbGlkZXMuZm9yRWFjaCgoc2xpZGUsIGkpID0+e1xuXG4gICAgICAgICAgICBpZihpID49IDYgfHwgc2xpZGUuY2xhc3NMaXN0LmNvbnRhaW5zKGBxdWVzdCR7aX1gKSl7XG4gICAgICAgICAgICAgICAgc2xpZGUucmVtb3ZlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgc2xpZGVzSWNvbnMuZm9yRWFjaCgoaWNvbiwgaSkgPT57XG4gICAgICAgICAgICBpZihpID49IDYgfHwgaWNvbi5jbGFzc0xpc3QuY29udGFpbnMoYHF1ZXN0JHtpfWApKXtcbiAgICAgICAgICAgICAgICBpY29uLnJlbW92ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuICAgIGlmKHdlZWsgPT09IDIpe1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSA2OyBpKyspe1xuICAgICAgICAgICAgbGV0IHdlZWsxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLnF1ZXN0JHtpfWApXG4gICAgICAgICAgICB3ZWVrMS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0ucmVtb3ZlKClcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNsaWRlcy5mb3JFYWNoKHNsaWRlID0+IHtcbiAgICAgICAgZ2xpdGNoTGF5ZXJzID0gWy4uLmdsaXRjaExheWVycywgLi4uc2xpZGUucXVlcnlTZWxlY3RvckFsbChcIi5nbGl0Y2hfX2xheWVyXCIpXTtcbiAgICB9KTtcblxuICAgIHNsaWRlc1tjdXJyZW50XS5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKTtcblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUdsaXRjaExheWVycyhpbmRleCkge1xuICAgICAgICBpZih3ZWVrID09PSAyKXtcbiAgICAgICAgICAgIGluZGV4ICs9IDZcbiAgICAgICAgfVxuICAgICAgICBnbGl0Y2hMYXllcnMuZm9yRWFjaChsYXllciA9PiB7XG4gICAgICAgICAgICBsYXllci5jbGFzc0xpc3QuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUuc3RhcnRzV2l0aChcInNsaWRlLWluZm8tZ2xpdGNoXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5yZW1vdmUoXCJzbGlkZS1pbmZvLWdsaXRjaFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5zdGFydHNXaXRoKFwicXVlc3RcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGxheWVyLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3RbMF0gIT09IFwic2xpZGVfX2luZm9cIikge1xuICAgICAgICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5hZGQoYHF1ZXN0JHtpbmRleH1gKTtcbiAgICAgICAgICAgICAgICBsYXllci5zdHlsZS5iYWNrZ3JvdW5kID0gYHVybChcIi4vaW1nL3F1ZXN0cy9zbGlkZSR7aW5kZXh9L3BlcnMucG5nXCIpIG5vLXJlcGVhdCAwIDAvY29udGFpbmA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5hZGQoXCJzbGlkZS1pbmZvLWdsaXRjaFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbW92ZVNsaWRlcihzbGlkZXMsIGRpcmVjdGlvbikge1xuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBcImxlZnRcIikge1xuICAgICAgICAgICAgLS1jdXJyZW50O1xuICAgICAgICAgICAgaWYgKGN1cnJlbnQgPCAwKSBjdXJyZW50ID0gc2xpZGVzLmxlbmd0aCAtIDE7XG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgICsrY3VycmVudDtcbiAgICAgICAgICAgIGlmIChjdXJyZW50ID4gc2xpZGVzLmxlbmd0aCAtIDEpIGN1cnJlbnQgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgc2xpZGVzLmZvckVhY2goKHNsaWRlLCBpKSA9PiB7XG4gICAgICAgICAgICBzbGlkZS5jbGFzc0xpc3QudG9nZ2xlKFwiX2FjdGl2ZVwiLCBpID09PSBjdXJyZW50KTtcbiAgICAgICAgICAgIHNsaWRlLmNsYXNzTGlzdC5yZW1vdmUoXCJnbGl0Y2hcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIFNsaWRlSWNvbnNJbml0KHNsaWRlc0ljb25zLCBjdXJyZW50KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBTbGlkZUljb25zSW5pdChpY29ucywgY3VycmVudCkge1xuICAgICAgICBpY29ucy5mb3JFYWNoKChpY29uLCBpY29uSW5kZXgpID0+IHtcbiAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcIl9jdXJyZW50XCIsIGN1cnJlbnQgPT09IGljb25JbmRleCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhbmRsZUNsaWNrKGRpcmVjdGlvbikge1xuICAgICAgICBzbGlkZXNbY3VycmVudF0uY2xhc3NMaXN0LmFkZChcImdsaXRjaFwiKTtcbiAgICAgICAgcmlnaHRCdG4uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuICAgICAgICBsZWZ0QnRuLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcbiAgICAgICAgY29uc3QgbmV4dFNsaWRlSW5kZXggPSBkaXJlY3Rpb24gPT09IFwibGVmdFwiID8gKGN1cnJlbnQgPT09IDAgPyBzbGlkZXMubGVuZ3RoIDogY3VycmVudCkgOiAoY3VycmVudCA9PT0gc2xpZGVzLmxlbmd0aCAtIDEgPyAxIDogY3VycmVudCArIDIpO1xuICAgICAgICB1cGRhdGVHbGl0Y2hMYXllcnMobmV4dFNsaWRlSW5kZXgpO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGdsaXRjaExheWVycy5mb3JFYWNoKGxheWVyID0+IHtcbiAgICAgICAgICAgICAgICBsYXllci5jbGFzc0xpc3QuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lLnN0YXJ0c1dpdGgoXCJzbGlkZS1pbmZvLWdsaXRjaFwiKSB8fCBjbGFzc05hbWUuc3RhcnRzV2l0aChcInF1ZXN0XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllci5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbW92ZVNsaWRlcihzbGlkZXMsIGRpcmVjdGlvbik7XG4gICAgICAgICAgICByaWdodEJ0bi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJpbml0aWFsXCI7XG4gICAgICAgICAgICBsZWZ0QnRuLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImluaXRpYWxcIjtcbiAgICAgICAgfSwgMTAwMCk7XG4gICAgfVxuXG4gICAgbGVmdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gaGFuZGxlQ2xpY2soXCJsZWZ0XCIpKTtcbiAgICByaWdodEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gaGFuZGxlQ2xpY2soXCJyaWdodFwiKSk7XG5cbiAgICBzbGlkZXNJY29ucy5mb3JFYWNoKChpY29uLCBpKSA9PiB7XG4gICAgICAgIGljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNsaWRlc0ljb25zLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJfY3VycmVudFwiKSk7XG4gICAgICAgICAgICB9LCAxMDAwKTtcblxuICAgICAgICAgICAgc2xpZGVzW2N1cnJlbnRdLmNsYXNzTGlzdC5hZGQoXCJnbGl0Y2hcIik7XG4gICAgICAgICAgICBjdXJyZW50ID0gaTtcbiAgICAgICAgICAgIHVwZGF0ZUdsaXRjaExheWVycyhjdXJyZW50ICsgMSk7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIFNsaWRlSWNvbnNJbml0KHNsaWRlc0ljb25zLCBjdXJyZW50KTtcbiAgICAgICAgICAgICAgICBzbGlkZXMuZm9yRWFjaCgoc2xpZGUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNsaWRlLmNsYXNzTGlzdC50b2dnbGUoXCJfYWN0aXZlXCIsIGluZGV4ID09PSBjdXJyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgc2xpZGUuY2xhc3NMaXN0LnJlbW92ZShcImdsaXRjaFwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByaWdodEJ0bi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJpbml0aWFsXCI7XG4gICAgICAgICAgICAgICAgbGVmdEJ0bi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJpbml0aWFsXCI7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBTbGlkZUljb25zSW5pdChzbGlkZXNJY29ucywgY3VycmVudCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT57XG5cblxuXG4gICAgICAgIGNvbnN0IHNsaWRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVcIik7XG4gICAgICAgIGNvbnN0IGxlZnRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlX19tb3ZlLWxlZnRcIik7XG4gICAgICAgIGNvbnN0IHJpZ2h0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZV9fbW92ZS1yaWdodFwiKTtcbiAgICAgICAgY29uc3Qgc2xpZGVzSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnF1ZXN0c19faWNvbnMtaXRlbVwiKTtcblxuICAgICAgICBsZXQgZ2xpdGNoTGF5ZXJzID0gW107XG4gICAgICAgIGxldCBjdXJyZW50ID0gMTtcbiAgICAgICAgLy8gbGV0IHdlZWsgPSAyO1xuICAgICAgICBsZXQgd2VlayA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwid2Vla1wiKSA/IHBhcnNlSW50KGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwid2Vla1wiKSkgOiAxO1xuXG4gICAgICAgIGlmKHdlZWsgPT09IDEpe1xuICAgICAgICAgICAgc2xpZGVzLmZvckVhY2goKHNsaWRlLCBpKSA9PntcblxuICAgICAgICAgICAgICAgIGlmKGkgPj0gNiB8fCBzbGlkZS5jbGFzc0xpc3QuY29udGFpbnMoYHF1ZXN0JHtpfWApKXtcbiAgICAgICAgICAgICAgICAgICAgc2xpZGUucmVtb3ZlKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgc2xpZGVzSWNvbnMuZm9yRWFjaCgoaWNvbiwgaSkgPT57XG4gICAgICAgICAgICAgICAgaWYoaSA+PSA2IHx8IGljb24uY2xhc3NMaXN0LmNvbnRhaW5zKGBxdWVzdCR7aX1gKSl7XG4gICAgICAgICAgICAgICAgICAgIGljb24ucmVtb3ZlKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIGlmKHdlZWsgPT09IDIpe1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNjsgaSsrKXtcbiAgICAgICAgICAgICAgICBsZXQgd2VlazEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAucXVlc3Qke2l9YClcbiAgICAgICAgICAgICAgICB3ZWVrMS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnJlbW92ZSgpXG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgc2xpZGVzLmZvckVhY2goc2xpZGUgPT4ge1xuICAgICAgICAgICAgZ2xpdGNoTGF5ZXJzID0gWy4uLmdsaXRjaExheWVycywgLi4uc2xpZGUucXVlcnlTZWxlY3RvckFsbChcIi5nbGl0Y2hfX2xheWVyXCIpXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2xpZGVzW2N1cnJlbnRdLmNsYXNzTGlzdC5hZGQoXCJfYWN0aXZlXCIpO1xuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUdsaXRjaExheWVycyhpbmRleCkge1xuICAgICAgICAgICAgaWYod2VlayA9PT0gMil7XG4gICAgICAgICAgICAgICAgaW5kZXggKz0gNlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2xpdGNoTGF5ZXJzLmZvckVhY2gobGF5ZXIgPT4ge1xuICAgICAgICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5mb3JFYWNoKGNsYXNzTmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUuc3RhcnRzV2l0aChcInNsaWRlLWluZm8tZ2xpdGNoXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllci5jbGFzc0xpc3QucmVtb3ZlKFwic2xpZGUtaW5mby1nbGl0Y2hcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5zdGFydHNXaXRoKFwicXVlc3RcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChsYXllci5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0WzBdICE9PSBcInNsaWRlX19pbmZvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuY2xhc3NMaXN0LmFkZChgcXVlc3Qke2luZGV4fWApO1xuICAgICAgICAgICAgICAgICAgICBsYXllci5zdHlsZS5iYWNrZ3JvdW5kID0gYHVybChcIi4vaW1nL3F1ZXN0cy9zbGlkZSR7aW5kZXh9L3BlcnMucG5nXCIpIG5vLXJlcGVhdCAwIDAvY29udGFpbmA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuY2xhc3NMaXN0LmFkZChcInNsaWRlLWluZm8tZ2xpdGNoXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbW92ZVNsaWRlcihzbGlkZXMsIGRpcmVjdGlvbikge1xuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJsZWZ0XCIpIHtcbiAgICAgICAgICAgICAgICAtLWN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgPCAwKSBjdXJyZW50ID0gc2xpZGVzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICAgICAgKytjdXJyZW50O1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ID4gc2xpZGVzLmxlbmd0aCAtIDEpIGN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzbGlkZXMuZm9yRWFjaCgoc2xpZGUsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBzbGlkZS5jbGFzc0xpc3QudG9nZ2xlKFwiX2FjdGl2ZVwiLCBpID09PSBjdXJyZW50KTtcbiAgICAgICAgICAgICAgICBzbGlkZS5jbGFzc0xpc3QucmVtb3ZlKFwiZ2xpdGNoXCIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIFNsaWRlSWNvbnNJbml0KHNsaWRlc0ljb25zLCBjdXJyZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIFNsaWRlSWNvbnNJbml0KGljb25zLCBjdXJyZW50KSB7XG4gICAgICAgICAgICBpY29ucy5mb3JFYWNoKChpY29uLCBpY29uSW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBpY29uLmNsYXNzTGlzdC50b2dnbGUoXCJfY3VycmVudFwiLCBjdXJyZW50ID09PSBpY29uSW5kZXgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVDbGljayhkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIHNsaWRlc1tjdXJyZW50XS5jbGFzc0xpc3QuYWRkKFwiZ2xpdGNoXCIpO1xuICAgICAgICAgICAgcmlnaHRCdG4uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuICAgICAgICAgICAgbGVmdEJ0bi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgICAgICAgICBjb25zdCBuZXh0U2xpZGVJbmRleCA9IGRpcmVjdGlvbiA9PT0gXCJsZWZ0XCIgPyAoY3VycmVudCA9PT0gMCA/IHNsaWRlcy5sZW5ndGggOiBjdXJyZW50KSA6IChjdXJyZW50ID09PSBzbGlkZXMubGVuZ3RoIC0gMSA/IDEgOiBjdXJyZW50ICsgMik7XG4gICAgICAgICAgICB1cGRhdGVHbGl0Y2hMYXllcnMobmV4dFNsaWRlSW5kZXgpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgZ2xpdGNoTGF5ZXJzLmZvckVhY2gobGF5ZXIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsYXllci5jbGFzc0xpc3QuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5zdGFydHNXaXRoKFwic2xpZGUtaW5mby1nbGl0Y2hcIikgfHwgY2xhc3NOYW1lLnN0YXJ0c1dpdGgoXCJxdWVzdFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbW92ZVNsaWRlcihzbGlkZXMsIGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgcmlnaHRCdG4uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiaW5pdGlhbFwiO1xuICAgICAgICAgICAgICAgIGxlZnRCdG4uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiaW5pdGlhbFwiO1xuICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZWZ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBoYW5kbGVDbGljayhcImxlZnRcIikpO1xuICAgICAgICByaWdodEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gaGFuZGxlQ2xpY2soXCJyaWdodFwiKSk7XG5cbiAgICAgICAgc2xpZGVzSWNvbnMuZm9yRWFjaCgoaWNvbiwgaSkgPT4ge1xuICAgICAgICAgICAgaWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXNJY29ucy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwiX2N1cnJlbnRcIikpO1xuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuXG4gICAgICAgICAgICAgICAgc2xpZGVzW2N1cnJlbnRdLmNsYXNzTGlzdC5hZGQoXCJnbGl0Y2hcIik7XG4gICAgICAgICAgICAgICAgY3VycmVudCA9IGk7XG4gICAgICAgICAgICAgICAgdXBkYXRlR2xpdGNoTGF5ZXJzKGN1cnJlbnQgKyAxKTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBTbGlkZUljb25zSW5pdChzbGlkZXNJY29ucywgY3VycmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHNsaWRlcy5mb3JFYWNoKChzbGlkZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlLmNsYXNzTGlzdC50b2dnbGUoXCJfYWN0aXZlXCIsIGluZGV4ID09PSBjdXJyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlLmNsYXNzTGlzdC5yZW1vdmUoXCJnbGl0Y2hcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByaWdodEJ0bi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJpbml0aWFsXCI7XG4gICAgICAgICAgICAgICAgICAgIGxlZnRCdG4uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiaW5pdGlhbFwiO1xuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIFNsaWRlSWNvbnNJbml0KHNsaWRlc0ljb25zLCBjdXJyZW50KTtcblxuLy8gZm9yIHRlc3RcblxuICAgICAgICBjb25zdCB3ZWVrMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VlazFcIik7XG4gICAgICAgIGNvbnN0IHdlZWsyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53ZWVrMlwiKTtcblxuICAgICAgICB3ZWVrMS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ3ZWVrXCIsIDEpO1xuICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHdlZWsyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIndlZWtcIiwgMik7XG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgfSk7XG5cblxuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBwcmVsb2FkSW1hZ2VzKCl7XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDEyOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHBlcnMgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IHBlcnNNb2IgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IHNsaWRlQmcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IHNsaWRlQmdNb2IgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IG1haW5CdG4gPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIHBlcnMuc3JjID0gYC4vaW1nL3F1ZXN0cy9zbGlkZSR7aX0vcGVycy5wbmdgO1xuICAgICAgICAgICAgcGVyc01vYi5zcmMgPSBgLi9pbWcvcXVlc3RzL3NsaWRlJHtpfS9wZXJzLW1vYi5wbmdgO1xuICAgICAgICAgICAgc2xpZGVCZy5zcmMgPSBgLi9pbWcvcXVlc3RzL3NsaWRlJHtpfS9zbGlkZS1iZy5wbmdgO1xuICAgICAgICAgICAgc2xpZGVCZ01vYi5zcmMgPSBgLi9pbWcvcXVlc3RzL3NsaWRlJHtpfS9zbGlkZS1iZy1tb2IucG5nYDtcbiAgICAgICAgICAgIG1haW5CdG4uc3JjID0gYC4vaW1nL2J1dHRvbnMvYnRuLWhvdmVyLWJnLnBuZ2A7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVsb2FkSW1hZ2VzKClcblxuLy8gZm9yIHRlc3RcblxuICAgIGNvbnN0IHdlZWsxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53ZWVrMVwiKTtcbiAgICBjb25zdCB3ZWVrMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VlazJcIik7XG5cbiAgICB3ZWVrMS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIndlZWtcIiwgMSk7XG4gICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgIH0pO1xuXG4gICAgd2VlazIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ3ZWVrXCIsIDIpO1xuICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICB9KTtcblxuXG59KVxuXG4iXX0=
